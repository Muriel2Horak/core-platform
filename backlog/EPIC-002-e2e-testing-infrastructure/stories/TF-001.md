# TF-001: Test Registry & Tracking

> **Evidence:** DatabÃ¡ze vÅ¡ech testÅ¯ s mapovÃ¡nÃ­m na User Stories

**Status:** ğŸ”µ TODO  
**Effort:** ~8 hodin  
**LOC:** ~600 Å™Ã¡dkÅ¯

---

## ğŸ“‹ User Story

**As a** developer  
**I want** centrÃ¡lnÃ­ registr testÅ¯ s vazbou na User Stories  
**So that** vÃ­me jakÃ© US jsou otestovanÃ© a kterÃ© ne

---

## ğŸ¯ Acceptance Criteria

**GIVEN** test s `@CORE-123` tagem  
**WHEN** test probÄ›hne  
**THEN** zaznamenÃ¡ se do test_registry tabulky  
**AND** status (PASS/FAIL) se uloÅ¾Ã­  
**AND** coverage metriky se aktualizujÃ­

---

## ğŸ—ï¸ Architecture

```
Test Execution Flow
â”‚
â”œâ”€â”€ E2E Test (Playwright)
â”‚   â””â”€â”€ RegistryReporter.onTestEnd()
â”‚       â””â”€â”€ POST /api/test-registry
â”‚           â””â”€â”€ TestRegistryService.record()
â”‚               â””â”€â”€ test_registry table
â”‚
â”œâ”€â”€ Unit Test (JUnit)
â”‚   â””â”€â”€ TestRegistryListener.testFinished()
â”‚       â””â”€â”€ TestRegistryRepository.save()
â”‚           â””â”€â”€ test_registry table
â”‚
â””â”€â”€ Coverage Query
    â””â”€â”€ GET /api/test-registry/coverage
        â””â”€â”€ SQL: COUNT(DISTINCT user_story_id)
```

---

## ğŸ“¦ Implementation Tasks

DetailnÃ­ implementaÄnÃ­ tasky jsou v adresÃ¡Å™i [`TF-001/`](./TF-001/):

1. [T1: Database Schema](./TF-001/T1-database-schema.md) - Migration + tabulka `test_registry`
2. [T2: Backend Model & Repository](./TF-001/T2-backend-model-repository.md) - JPA entity + repository
3. [T3: REST API Controller](./TF-001/T3-rest-api-controller.md) - `/api/test-registry` endpoints
4. [T4: Playwright Reporter](./TF-001/T4-playwright-reporter.md) - Auto-register E2E tests
5. [T5: JUnit Listener](./TF-001/T5-junit-listener.md) - `@UserStory` annotation support

**Task Overview:** [TF-001/README.md](./TF-001/README.md)

---

## ğŸ¯ Definition of Done

- [ ] Database migration executed (test_registry table exists)
- [ ] Backend API responds: `GET /api/test-registry/story/CORE-123`
- [ ] Backend API responds: `GET /api/test-registry/coverage`
- [ ] Backend API accepts: `POST /api/test-registry` (record test run)
- [ ] Playwright reporter registruje E2E testy do DB
- [ ] JUnit listener registruje Unit testy s `@UserStory` annotation
- [ ] Coverage endpoint vracÃ­ sprÃ¡vnÃ© procento otestovanÃ½ch US
- [ ] Unit testy pro TestRegistryService (80%+ coverage)
- [ ] Integration test: E2E test â†’ zaznamenÃ¡ se do DB
- [ ] Documentation: API endpoints v README

---

## ğŸ“ˆ Success Metrics

- **Registration Rate**: 100% testÅ¯ s `@CORE-XXX` tagem se zaregistruje
- **API Performance**: GET /coverage response < 200ms
- **Data Accuracy**: 0% duplicate test_id records
- **Coverage Visibility**: Dashboard zobrazuje real-time coverage

---

## ğŸ”— Dependencies

- PostgreSQL (test_registry table)
- Spring Boot (REST API)
- Playwright 1.42+ (Reporter API)
- JUnit 5 (RunListener API)

---

## ğŸ“… Implementation Timeline

- **Day 1**: T1 Database schema + T2 Backend model
- **Day 2**: T3 REST API controller + unit tests
- **Day 3**: T4 Playwright reporter
- **Day 4**: T5 JUnit listener
- **Day 5**: Integration testing + documentation

---

**Next Story:** [TF-002: Test Tagging System](./TF-002.md)
